"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[980],{12980:function(e,s,t){t.d(s,{Z:function(){return V}});var r,n,a=t(68571),i=t(6507),c=t(49059),o=t(24149),l=t(38727),d=t(45411),m=t(17138),u=t(38716),j=t(21902),h=t(51904),_=t(50845),x=t(60045),f=t(83068),g=t(77053),p=t(24081),v=t(75901),N=t(12576),b=t.n(N),O=t(83537),E=t(53704),S=j.memo((function(e){var s=e.userObject,t=e.itemObject,r=e.actionStr,n=e.timestamp,a="/u/".concat(s.shortId),i=(0,E.jsx)(O.default,{href:a,children:(0,E.jsx)("a",{className:"username__text",children:s.profile.tag})});return(0,E.jsxs)("div",{className:"action__card",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:s,size:32}),(0,E.jsx)("img",{src:(0,p.SF)("icons/User/BlueUser.svg"),width:16,height:16})]}),(0,E.jsxs)("div",{className:"actionStr",children:[(0,E.jsxs)("span",{children:[i," ",r]}),(0,E.jsx)("span",{className:"action__timestamp",children:b()(n).fromNow()})]}),(0,E.jsx)("img",{onClick:function(){(0,v.XN)({itemOrBuyable:t,owner:s,onModalClose:function(){}})},className:"pet__img",src:(0,p.n7)(t.definition.primaryMedia)})]})})),w=j.memo((function(e){var s=e.userObject,t=e.profileObject,r=e.isPetChange,n=e.actionStr,a=e.timestamp,i="/u/".concat(s.shortId),c=(0,E.jsx)(O.default,{href:i,children:(0,E.jsx)("a",{className:"username__text",children:s.profile.tag})});return(0,E.jsxs)("div",{className:"action__card",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:s,size:32}),(0,E.jsx)("img",{src:(0,p.SF)("icons/User/BlueUser.svg"),width:16,height:16})]}),(0,E.jsxs)("div",{className:"actionStr",children:[(0,E.jsxs)("span",{children:[c," ",n]}),(0,E.jsx)("span",{className:"action__timestamp",children:b()(a).fromNow()})]}),r&&t.equippedPet&&(0,E.jsx)("img",{onClick:function(){r&&(0,v.XN)({itemOrBuyable:t.equippedPet,owner:s,onModalClose:function(){}})},className:"pet__img",src:(0,p.n7)(t.equippedPet.definition.primaryMedia)})]})})),U=j.memo((function(e){var s=e.currentUserReceived,t=e.currentUserSent,r=e.userObject,n=e.relationshipObject,a=e.timestamp,i="/u/".concat(r.shortId),c="/u/".concat(n.userTwo.shortId),o=(0,E.jsx)(O.default,{href:i,children:(0,E.jsx)("a",{className:"username__text",onClick:function(e){return e.stopPropagation()},children:t?"You":r.profile.tag})}),l=s?"you":(0,E.jsx)(O.default,{href:c,children:(0,E.jsx)("a",{className:"username__text",onClick:function(e){return e.stopPropagation()},children:n.userTwo.profile.tag})}),d=(0,E.jsxs)("span",{children:[o," followed ",l]});return(0,E.jsxs)("div",{className:"action__card",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:r,size:32}),(0,E.jsx)("img",{src:(0,p.SF)("icons/User/BlueUser.svg"),width:16,height:16})]}),(0,E.jsxs)("div",{className:"no__margin__left actionStr",children:[d,(0,E.jsx)("span",{className:"action__timestamp",children:b()(a).fromNow()})]})]})})),P=t(94778),T=t(69775),M=j.memo((function(e){var s=e.guildObject,t=e.questCompleted,r=e.actionStr,n=e.timestamp,a=(0,E.jsx)("a",{className:"guild__name",children:s.discordName}),i=(0,E.jsx)(P.Z,{discordGuild:s,size:32}),c=(0,E.jsx)("span",{className:"guild",children:"Guild Quest"}),o=(0,E.jsxs)("span",{children:[a," ",r," ",c]});return(0,E.jsxs)("div",{className:"action__card guild",children:[(0,E.jsxs)("div",{className:"user__img",children:[i,(0,E.jsx)("img",{src:(0,p.SF)("landing/yellow-quest-scroll.svg")})]}),(0,E.jsxs)("div",{className:"actionStr",children:[o,(0,E.jsxs)("span",{className:"action__timestamp",children:[b()(n).fromNow(),t&&(0,E.jsxs)("span",{className:"quest__reward",children:[(0,E.jsx)(T.Z,{style:{height:"16px",width:"16px"}}),f.nK]})]})]}),(0,E.jsx)("div",{className:"guildImg",children:(0,E.jsx)("img",{src:(0,p.SF)(t?"icons/Flag/GreenFlag.svg":"icons/Flag/Flag.svg")})})]})})),C=t(20622),D=j.memo((function(e){var s=e.currentUser,t=e.userObject,r=e.gameObject,n=e.actionStr,a=e.timestamp,i="/u/".concat(t.shortId),c=(null===s||void 0===s?void 0:s.id)===t.id?"You":t.profile.tag,o=(0,E.jsx)(O.default,{href:i,children:(0,E.jsx)("a",{className:"username__text",children:c})}),l=r.id,d=r.name,m=r.slug,u="/g/".concat(m||l),j=(0,E.jsx)("span",{className:"game__name",children:(0,E.jsx)(O.default,{href:u,as:"/g/".concat(l),children:(0,E.jsx)("a",{children:d})})});return(0,E.jsxs)("div",{className:"action__card",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:t,size:32}),(0,E.jsx)("img",{src:(0,p.SF)("icons/GameController/LavenderGameController.svg"),height:32,width:32})]}),(0,E.jsxs)("div",{className:"actionStr game",children:[(0,E.jsxs)("span",{children:[o," ",n,"\n",j]}),(0,E.jsx)("span",{className:"action__timestamp",children:b()(a).fromNow()})]}),(0,E.jsx)(C.Z,{className:"game__avatar",game:r,size:48})]})})),F=t(23284),y=j.memo((function(e){var s=e.userObject,t=e.itemObject,r=e.timestamp,n="/u/".concat(s.shortId),a=(0,E.jsx)(O.default,{href:n,children:(0,E.jsx)("a",{className:"username__text",onClick:function(e){return e.stopPropagation()},children:s.profile.tag})});return(0,E.jsxs)("div",{className:"action__card",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:s,size:32}),(0,E.jsx)("img",{src:(0,p.SF)("icons/Store-2/BlueStore-2.svg")})]}),(0,E.jsxs)("div",{className:"actionStr no__margin__left",children:[(0,E.jsxs)("span",{children:[a," acquired a new"," ",(0,F.v)(t.definition.rarity)," pet"]}),(0,E.jsx)("span",{className:"action__timestamp",children:b()(r).fromNow()})]}),(0,E.jsx)("img",{className:"pet__img",onClick:function(){(0,v.XN)({itemOrBuyable:t,owner:s,onModalClose:function(){}})},src:(0,p.n7)(t.definition.primaryMedia)})]})})),I=j.memo((function(e){var s=e.userObject,t=e.questObject,r=e.actionStr,n=e.timestamp;if(!t)return null;var a=t.definition,i=a.name,c=a.coinReward,o="/u/".concat(s.shortId),l=(0,E.jsx)(O.default,{href:o,children:(0,E.jsx)("a",{className:"username__text",onClick:function(e){return e.stopPropagation()},children:s.profile.tag})}),d=(0,E.jsxs)("span",{children:[l," ",r]}),m=t.game,u=m.id,j=m.name,h=m.slug,_="/g/".concat(h||u),x=(0,E.jsx)("span",{className:"game__name",children:(0,E.jsx)(O.default,{href:_,as:"/g/".concat(u),children:(0,E.jsx)("a",{children:j})})});return(0,E.jsxs)("div",{className:"action__card action__card--quest",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:s,size:32}),(0,E.jsx)("img",{src:(0,p.SF)("landing/yellow-quest-scroll.svg")})]}),(0,E.jsxs)("div",{className:"actionStr",children:[d,(0,E.jsxs)("span",{className:"quest__description",children:[(0,E.jsxs)("span",{className:"quest__name",children:[" ",i]})," in ",x]}),(0,E.jsxs)("span",{className:"action__timestamp",children:[b()(n).fromNow(),(0,E.jsxs)("span",{className:"quest__reward",children:[(0,E.jsx)(T.Z,{style:{height:"16px",width:"16px"}}),c]})]})]}),(0,E.jsx)("div",{className:"game__avatarBox",children:(0,E.jsx)(C.Z,{className:"game__avatar",game:t.game,size:48})})]})})),Z=j.memo((function(e){var s,t,r=e.userObject,n=e.targetLink,a=e.targetName,i=e.isPost,c=e.isReaction,o=void 0!==c&&c,l=e.actionStr,d=e.timestamp,m=e.isCurrentUserPost,u=e.isCurrentUserAction,j=e.isSameActorAndTargetUser;s=i?"post":"comment";r.profile;var h,_="/u/".concat(r.shortId);return h=u?(0,E.jsx)(O.default,{href:_,children:(0,E.jsx)("a",{className:"username__text",onClick:function(e){return e.stopPropagation()},children:"You"})}):(0,E.jsx)(O.default,{href:_,children:(0,E.jsx)("a",{className:"username__text",onClick:function(e){return e.stopPropagation()},children:r.profile.tag})}),t=m?(0,E.jsxs)("span",{children:[h," ",l," your ",s]}):j?(0,E.jsxs)("span",{children:[h," ",l," their own ",s]}):(0,E.jsxs)("span",{children:[h," ",l," ",(0,E.jsx)(O.default,{href:n,children:(0,E.jsx)("a",{className:"username__text",onClick:function(e){return e.stopPropagation()},children:a})}),"'s ",s]}),(0,E.jsxs)("div",{className:"action__card",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:r,size:32}),(0,E.jsx)("img",{src:(0,p.SF)(o?"icons/Like/PinkLike.svg":"icons/Comment/BlueComment.svg")})]}),(0,E.jsxs)("div",{className:"actionStr",children:[t,(0,E.jsx)("span",{className:"action__timestamp",children:b()(d).fromNow()})]})]})})),k=t(75429),A=t(76751),L=j.memo((function(e){var s=e.user,t=e.game,r=e.oldRank,n=e.newRank,a=e.timestamp,i="/u/".concat(s.shortId);return(0,E.jsxs)("div",{className:"action__card action__card--rank",children:[(0,E.jsxs)("div",{className:"user__img",children:[(0,E.jsx)(g.Z,{user:s,size:32}),(0,E.jsx)("img",{src:(0,p.SF)("icons/GameController/LavenderGameController.svg"),height:32,width:32})]}),(0,E.jsxs)("div",{className:-1===r?"actionStr no__margin__left":"actionStr no__margin__left narrow",children:[(0,E.jsxs)("span",{children:[(0,E.jsx)(O.default,{href:i,children:(0,E.jsx)("a",{className:"username__text",children:s.profile.tag})}),-1===r?" appeared on the ":n-r>0?" moved down on the ":" moved up on the ",(0,E.jsx)(O.default,{href:"/lb/".concat(t.slug?t.slug:t.id),children:(0,E.jsx)("a",{className:"game__name",style:{fontWeight:"bold",color:"white"},children:t.name})}),"\xa0leaderboard"]}),(0,E.jsx)("span",{className:"action__timestamp",children:b()(a).fromNow()})]}),-1===r?(0,E.jsx)(E.Fragment,{}):n-r>0?(0,E.jsx)("div",{className:"rank__tag rank__down__border",children:(0,E.jsxs)(A.Z,{className:"rank__text",children:["-",n-r,(0,E.jsx)("img",{src:(0,p.SF)("icons/Arrow/RedArrow.svg"),style:{marginBottom:"2px",transform:"rotate(-90deg)"},height:12,width:12,alt:"rank down arrow"})]})}):(0,E.jsx)("div",{className:"rank__tag rank__up__border",children:(0,E.jsxs)("span",{className:"rank__text",children:["+",r-n,(0,E.jsx)("img",{src:(0,p.SF)("icons/Arrow/GreenArrow.svg"),style:{marginBottom:"2px",transform:"rotate(90deg)"},height:12,width:12,alt:"rank up arrow"})]})}),-1===r?(0,E.jsx)("div",{className:"rank__box",children:(0,E.jsx)(O.default,{href:"/lb/".concat(t.slug?t.slug:t.id),children:(0,E.jsx)("a",{children:(0,E.jsx)(C.Z,{game:t,size:40})})})}):(0,E.jsx)("div",{className:"rank__box",children:(0,E.jsx)(k.y,{rank:n})})]})})),R=j.memo((function(e){var s=e.action,t=e.currentUser,r=s.description,n=(0,f.e$)(r),a=s.timestamp;if((null===s.timestamp||new Date(s.timestamp).getTime()>(new Date).getTime())&&(a=new Date),r===f.Mb.PET_UPDATE){var i,c;if("ProfileDTO"===(null===s||void 0===s||null===(i=s.object)||void 0===i?void 0:i.__typename)){var o=s.actor,l=s.object;return(0,E.jsx)(w,{userObject:o,profileObject:l,isPetChange:!0,actionStr:n,timestamp:a})}if("ItemDTO"===(null===s||void 0===s||null===(c=s.object)||void 0===c?void 0:c.__typename)){var d=s.actor,m=s.object;return(0,E.jsx)(S,{userObject:d,itemObject:m,actionStr:n,timestamp:a})}return(0,E.jsx)(E.Fragment,{})}if(r===f.Mb.AVATAR_UPDATE||r===f.Mb.BANNER_UPDATE||r===f.Mb.BIO_UPDATE){var u=s.actor,j=s.object;return(0,E.jsx)(w,{userObject:u,profileObject:j,isPetChange:!1,actionStr:n,timestamp:a})}if(r===f.Mb.ADDED_FRIEND){var h=s.actor,_=s.object;return(0,E.jsx)(U,{userObject:h,relationshipObject:_,timestamp:a,currentUserReceived:_.userTwo.id===(null===t||void 0===t?void 0:t.id),currentUserSent:_.userOne.id===(null===t||void 0===t?void 0:t.id)})}if(r===f.Mb.GUILD_QUEST_COMPLETED||r===f.Mb.GUILD_QUEST_FAILED){var g=s.actor,p=r===f.Mb.GUILD_QUEST_COMPLETED;return(0,E.jsx)(M,{guildObject:g,questCompleted:p,actionStr:n,timestamp:a})}if(r===f.Mb.PLAYING_GAME){var v=s.actor,N=s.object;return N?(0,E.jsx)(D,{currentUser:t,userObject:v,gameObject:N,actionStr:n,timestamp:a}):null}if(r===f.Mb.BOUGHT_ITEM||r===f.Mb.ACQUIRED_ITEM){var b=s.actor,O=s.object;return(0,E.jsx)(y,{userObject:b,itemObject:O,timestamp:a})}if(r===f.Mb.COMMENTED_POST||r===f.Mb.LIKED_POST){var P,T,C,F,k,A,R=s.actor,G=R.id===(null===t||void 0===t?void 0:t.id);if("PostDTO"===(null===(P=s.target)||void 0===P?void 0:P.__typename)){var q=s.target,B=q.user;T=!0,F=B.profile.tag,C="/u/".concat(B.shortId),k=q.user.id===(null===t||void 0===t?void 0:t.id),A=R.id===q.user.id}else{var $=s.target;if(!$)return null;T=!1,F=$.tag,C="/u/".concat($.shortId),k=$.userId===(null===t||void 0===t?void 0:t.id),A=R.id===$.userId}return(0,E.jsx)(Z,{isReaction:r===f.Mb.LIKED_POST,userObject:R,targetLink:C,targetName:F,isPost:T,actionStr:n,timestamp:a,isCurrentUserPost:k,isCurrentUserAction:G,isSameActorAndTargetUser:A})}if(r===f.Mb.USER_QUEST_COMPLETED){var z=s.actor,Q=s.object;return(0,E.jsx)(I,{userObject:z,questObject:Q,actionStr:n,timestamp:a})}if(r===f.Mb.RANK_CHANGE){var H=s.actor,K=s.target,V=s.context.split(":",2),Y=(0,x.Z)(V,2),W=Y[0],X=Y[1];return(0,E.jsx)(L,{user:H,game:K,oldRank:parseInt(W,10),newRank:parseInt(X,10),timestamp:a})}return null})),G=t(15999),q=t(58346);function B(e,s){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);s&&(r=r.filter((function(s){return Object.getOwnPropertyDescriptor(e,s).enumerable}))),t.push.apply(t,r)}return t}function $(e){for(var s=1;s<arguments.length;s++){var t=null!=arguments[s]?arguments[s]:{};s%2?B(Object(t),!0).forEach((function(s){(0,a.Z)(e,s,t[s])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):B(Object(t)).forEach((function(s){Object.defineProperty(e,s,Object.getOwnPropertyDescriptor(t,s))}))}return e}var z=(0,d.ZP)(r||(r=(0,c.Z)(["\n  query getRecentAction(\n    $cursor: Cursor\n    $limit: Float\n    $actors: [String!]!\n    $feed: Float!\n  ) {\n    getRecentAction(\n      cursor: $cursor\n      limit: $limit\n      actors: $actors\n      feed: $feed\n    ) {\n      count\n      cursor {\n        beforeCursor\n        afterCursor\n      }\n      data {\n        ...actionFields\n      }\n    }\n  }\n  ","\n"])),m.pW),Q=(0,d.ZP)(n||(n=(0,c.Z)(["\n  subscription OnActionUpdated($actors: [String!]!, $feed: Float!) {\n    actionUpdated(actors: $actors, feed: $feed) {\n      ...actionFields\n    }\n  }\n  ","\n"])),m.pW),H=function(e){var s=e.data,t=(e.fetchMore,e.maxLength),r=e.title,n=e.subscribeToMore,a=(0,q.Z)().currentUser,c=s.getRecentAction,l=c.data,d=(c.cursor,c.limit,(0,j.useState)(l)),m=d[0],u=d[1];return(0,j.useEffect)((function(){u((0,i.Z)(l.slice(0,t)))}),[l]),(0,j.useEffect)((function(){var e=n(),s=function(){"visible"===document.visibilityState?e=n():e()};return document.addEventListener("visibilitychange",s),function(){e(),document.removeEventListener("visibilitychange",s)}}),[]),(0,E.jsxs)(h.Z,{className:"mini-feed",children:[(0,E.jsx)("h3",{className:"activity__text",children:r}),(0,E.jsx)("div",{className:"mini__feed",children:m.map((function(e){return(0,E.jsx)(o.SV,{fallback:(0,E.jsx)(E.Fragment,{}),onError:function(e){return console.log("Error in MiniFeed component!",e)},children:(0,E.jsx)(R,{action:e,currentUser:a})},e.id)}))})]})},K=function(e){var s=e.feed,t=void 0===s?f.Ox.HOMEPAGE:s,r=e.actors,n=void 0===r?[f.Z3.UNFILTERED]:r,a=e.maxLength,i=void 0===a?10:a,c=e.title,o=void 0===c?"Activity Feed":c,d=(0,l.useQuery)(z,{variables:{actors:n,feed:t,limit:10,cursor:{}}}),m=d.loading,h=d.data,_=d.error,x=d.fetchMore,g=d.subscribeToMore,p=d.refetch;if((0,j.useEffect)((function(){h&&p({actors:n,feed:t,limit:10,cursor:{}})}),[n,t]),!h){if(m)return(0,E.jsx)(u.Z,{});if(_)return(0,E.jsxs)("div",{children:["Something unexpected went wrong: ",_.message]})}return(0,E.jsx)(H,{data:h,fetchMore:x,subscribeToMore:function(){return g({document:Q,variables:{actors:n,feed:t},updateQuery:function(e,s){var t=s.subscriptionData;if(!t.data)return e;var r=t.data.actionUpdated;return Object.assign({},e,{getRecentAction:$($({},e.getRecentAction),{},{data:[r]})})}})},maxLength:i,title:o})},V=function(e){var s=e.actors,t=(0,G.Z)(),r=(0,l.useReactiveVar)(v.AV),n=(0,j.useState)(null!==s&&void 0!==s?s:[f.Z3.UNFILTERED]),a=n[0],i=n[1];if((0,j.useEffect)((function(){s&&i(s)}),[s]),t)return(0,E.jsx)(u.Z,{});return(0,E.jsxs)(E.Fragment,{children:[r&&(0,E.jsx)(E.Fragment,{children:(0,E.jsx)(_.Z.Group,{options:[{label:"Unfiltered",value:f.Z3.UNFILTERED},{label:"Mutual Homeguild",value:f.Z3.MUTUAL_HOMEGUILD},{label:"Friends",value:f.Z3.FRIENDS}],value:a,onChange:function(e){if(0!==e.length)if(e.length>1&&e.includes(f.Z3.UNFILTERED)){if(!a.includes(f.Z3.UNFILTERED))return void i([f.Z3.UNFILTERED]);var s=e.filter((function(e){return e!==f.Z3.UNFILTERED}));i(s)}else i(e);else i([f.Z3.UNFILTERED])}})}),(0,E.jsx)(K,$($({},e),{},{actors:a}))]})}}}]);
//# sourceMappingURL=980-d84910baa7f4ff24729d.js.map